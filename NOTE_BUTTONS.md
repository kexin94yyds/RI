# 📝 笔记窗口完整功能清单

## 🎨 界面设计（一比一复刻 Note-taking-tool）

### 顶部工具栏布局

```
┌────────────────────────────────────────────────────┐
│ ● ⬆ 🗑 ↗ 📋     📝 笔记     [模式 ▾]            │
│ ↑ 5个macOS按钮   标题      模式切换器            │
└────────────────────────────────────────────────────┘
```

## 🔘 五个 macOS 风格按钮

### 1. ● 关闭按钮（红色 #ff5f56）
- **功能**: 隐藏笔记窗口
- **快捷键**: 无
- **效果**: 窗口隐藏，内容自动保存

### 2. ⬆ 导出按钮（蓝色 #007AFF）
- **功能**: 导出笔记为 Markdown
- **操作**: 
  - 点击后内容复制到剪贴板
  - 可粘贴到任何地方保存
- **文件名格式**: `模式名-笔记-日期.md`

### 3. 🗑 清理缓存按钮（黄色 #FFD60A）
- **功能**: 显示笔记存储状态
- **显示信息**:
  - 笔记总数
  - 占用空间
  - 模式数量

### 4. ↗ 分享按钮（绿色 #34C759）
- **功能**: 分享笔记内容
- **分享选项**:
  - 📋 复制内容
  - ✉️ 通过邮件

### 5. 📋 一键复制按钮（紫色 #AF52DE）
- **功能**: 复制全部内容到剪贴板
- **效果**: 
  - 全选编辑器内容
  - 执行复制命令
  - 显示成功通知

## 🔄 模式切换器

### 功能
- **位置**: 右上角
- **显示**: 当前模式名称
- **颜色**: 橙色 (#ff9800)

### 交互
1. 点击按钮显示下拉菜单
2. 显示所有模式列表
3. 当前模式显示 ✓ 标记
4. 点击模式切换
5. 自动保存旧内容，加载新内容

### 切换流程
```
点击模式按钮
  ↓
显示模式列表
  ↓
选择目标模式
  ↓
保存当前笔记
  ↓
加载目标模式笔记
  ↓
更新标题和显示
  ↓
显示切换通知
```

## 📝 编辑器功能

### 富文本支持
- ✅ 粘贴富文本（保留格式）
- ✅ 粗体、斜体
- ✅ 标题
- ✅ 列表
- ✅ 代码块
- ✅ 链接

### 图片功能
- ✅ 粘贴图片（Cmd+V）
- ✅ 拖拽图片
- ✅ 自动压缩（800x800，质量0.8）
- ✅ 点击图片放大查看

### 编辑体验
- ✅ Tab 键缩进（4空格）
- ✅ 占位符提示
- ✅ 自动保存（500ms防抖）
- ✅ 失焦隐藏

## 💾 数据存储

### 存储结构
```javascript
{
  "wordModes": [
    {
      "id": "study",
      "name": "学习",
      "words": [...历史记录...],
      "notes": "<p>笔记内容...</p>"  // HTML格式
    }
  ]
}
```

### 保存机制
- **自动保存**: 编辑后500ms自动保存
- **切换保存**: 切换模式前自动保存
- **关闭保存**: 关闭窗口前自动保存

## 🎯 完整操作流程

### 场景1：快速记笔记
```
1. Cmd+M 呼出笔记窗口
   ↓
2. 直接输入内容
   ↓
3. 粘贴图片/富文本
   ↓
4. 点击外部或按 Cmd+M 隐藏
   ✅ 内容已自动保存
```

### 场景2：切换模式记笔记
```
1. 点击右上角模式按钮
   ↓
2. 选择"英语学习"
   ↓
3. 笔记内容自动切换
   ↓
4. 编辑英语笔记
   ✅ 保存到"英语学习"模式
```

### 场景3：导出笔记
```
1. 编辑完笔记
   ↓
2. 点击 ⬆ 导出按钮
   ↓
3. 内容复制到剪贴板
   ↓
4. 粘贴到任意位置保存
   ✅ Markdown格式完整
```

### 场景4：分享笔记
```
1. 点击 ↗ 分享按钮
   ↓
2. 选择分享方式：
   - 复制内容
   - 通过邮件
   ↓
3. 完成分享
   ✅ 内容已分享
```

## 🎨 UI 细节

### macOS 风格
- ✅ 圆形按钮（12px直径）
- ✅ 悬停时放大1.1倍
- ✅ 悬停时显示图标
- ✅ 默认透明图标
- ✅ 系统配色方案

### 交互反馈
- ✅ 按钮悬停效果
- ✅ 点击动画
- ✅ 成功/失败通知
- ✅ 模式切换通知

### 窗口行为
- ✅ 失焦自动隐藏（800ms延迟）
- ✅ 拖动标题栏移动窗口
- ✅ 固定在屏幕上方
- ✅ 跟随当前显示器

## ⌨️ 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Cmd+M` | 呼出/隐藏笔记窗口 |
| `Tab` | 插入4个空格缩进 |
| `Cmd+V` | 粘贴富文本/图片 |
| `Cmd+C` | 复制选中内容 |

## 📊 与原项目对比

### 功能完整度: 100%
- ✅ 5个macOS按钮完全复刻
- ✅ 模式切换器完全复刻
- ✅ 富文本编辑器完全复刻
- ✅ 图片功能完全复刻
- ✅ 自动保存完全复刻

### 适配改进
- ✅ Chrome扩展 → Electron应用
- ✅ chrome.storage → electron-store
- ✅ navigator.clipboard → Electron clipboard
- ✅ window.open → electron shell

## 🔧 技术实现

### 核心文件
- `note-window.html` - 笔记窗口页面
- `note-window.js` - 笔记窗口逻辑（900+行）
- `note-editor.css` - 编辑器样式
- `marked.min.js` - Markdown解析

### 关键函数
```javascript
// 模式管理
- loadModesAndContent()
- switchToMode()
- updateModeSwitcherDisplay()

// 编辑器
- handleEditorInput()
- handlePaste()
- handleImageFile()

// 按钮功能
- closeWindow()
- exportMarkdown()
- showStorageStatus()
- shareNote()
- quickCopyAllContent()

// 保存
- saveNoteContent()
- convertHtmlToMarkdown()
```

## 🎉 完成状态

✅ **所有功能已完整实现！**

- [x] 5个macOS风格按钮
- [x] 模式切换器
- [x] 富文本编辑器
- [x] 图片粘贴和拖拽
- [x] 自动保存
- [x] 导出Markdown
- [x] 分享功能
- [x] 一键复制
- [x] 存储管理
- [x] 通知系统

---

**现在按 `Cmd+M` 体验完整功能！** 🚀

