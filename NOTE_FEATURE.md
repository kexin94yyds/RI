# 📝 笔记功能使用说明

## 功能简介

现在 RI 项目已经集成了独立的笔记窗口功能！你可以在任何地方快速呼出笔记面板，记录想法、整理内容。

## 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Shift+Cmd+U` | 呼出/隐藏主窗口（历史记录） |
| `Cmd+U` | 快速保存剪贴板（不显示窗口） |
| `Cmd+M` | **呼出/隐藏笔记窗口** ⭐️ |

## 核心特性

### ✅ 模式绑定
- 每个模式都有独立的笔记内容
- 在笔记窗口右上角可以切换模式
- 切换模式时，笔记内容自动切换

### ✅ 自动保存
- 编辑时自动保存（500ms 防抖）
- 无需手动保存，内容永不丢失

### ✅ 富文本支持
- 支持粘贴富文本（从网页、Word等）
- 支持直接粘贴图片
- 支持拖拽图片到编辑器

### ✅ Markdown 导出
- 点击左上角 ⬆️ 按钮导出
- 自动转换为 Markdown 格式
- 文件名格式：`模式名-笔记-日期.md`

## 使用流程

### 场景 1：快速记录笔记

```
1. 任何时候按 Cmd+M
   ↓
2. 笔记窗口出现在屏幕右侧
   ↓
3. 直接开始输入
   ↓
4. 按 Cmd+M 或点击其他地方，窗口自动隐藏
   ✅ 内容已自动保存
```

### 场景 2：按模式整理笔记

```
1. 主窗口选择"英语学习"模式
   ↓
2. 按 Cmd+U 保存单词到历史
   ↓
3. 按 Cmd+M 打开笔记
   ↓
4. 在笔记中整理学习心得
   ✅ 笔记和单词在同一个模式下
```

### 场景 3：粘贴图片

```
方法 1: 直接粘贴
- 复制图片（Cmd+C）
- 在笔记编辑器中粘贴（Cmd+V）

方法 2: 拖拽
- 将图片文件拖入笔记窗口
- 自动插入并压缩
```

### 场景 4：导出笔记

```
1. 在笔记窗口点击左上角 ⬆️
   ↓
2. 选择保存位置
   ↓
3. 文件保存为 .md 格式
   ✅ 可以用任何 Markdown 编辑器打开
```

## 数据存储

### 存储结构

```javascript
{
  "wordModes": [
    {
      "id": "default",
      "name": "默认",
      "words": [...历史记录...],
      "notes": "<p>这里是笔记内容...</p>"  // HTML 格式
    }
  ]
}
```

### 位置
- macOS: `~/Library/Application Support/word-recorder-electron/config.json`
- 图片保存在: `~/Library/Application Support/word-recorder-electron/clipboard-images/`

## 技巧

1. **同时使用两个窗口**
   - `Shift+Cmd+U` 打开主窗口查看历史
   - `Cmd+M` 打开笔记窗口编辑笔记
   - 两个窗口可以同时显示

2. **模式同步**
   - 主窗口切换模式
   - 笔记窗口会自动更新为对应模式的笔记

3. **失焦隐藏**
   - 点击其他应用，窗口自动隐藏
   - 再次按快捷键即可恢复

## 注意事项

⚠️ **图片存储**
- 图片以 base64 格式直接存储在笔记内容中
- 建议单张图片不超过 5MB
- 如果笔记包含大量图片，可能影响加载速度

⚠️ **内容格式**
- 笔记以 HTML 格式存储
- 导出时自动转换为 Markdown

## 开发信息

### 文件结构

```
RI/
├── note-window.html        # 笔记窗口页面
├── note-window.js          # 笔记窗口逻辑
├── note-editor.css         # 编辑器样式
├── marked.min.js           # Markdown 解析库
└── electron-main.js        # 主进程（包含窗口创建）
```

### 技术栈
- **编辑器**: contenteditable + 富文本处理
- **存储**: electron-store
- **图片**: base64 编码 + 压缩
- **导出**: HTML → Markdown 转换

## 常见问题

### Q: 如何查看所有模式的笔记？
A: 在笔记窗口右上角的下拉菜单中切换模式。

### Q: 笔记内容会丢失吗？
A: 不会。所有编辑都会自动保存（500ms 防抖）。

### Q: 可以导入 Markdown 文件吗？
A: 当前版本暂不支持导入，只支持导出。可以复制内容粘贴进来。

### Q: 图片太大怎么办？
A: 图片会自动压缩到最大 800x800，质量 0.8。

---

## 🎉 开始使用

按 **`Cmd+M`** 试试吧！

